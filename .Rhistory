getwd()
setwd("~/GitHub/Placenta_RNAseq_WGCNA")
#Raw count sum/depth
meta_data_cp = read.csv(file = "meta_data_cp_Sept8.csv", header = T)
View(meta_data_cp)
?read.csv
View(meta_data_cp)
#Raw count sum/depth
meta_data_cp = read.csv(file = "meta_data_cp_Sept8.csv", sep = ",",header = T)
library(readr)
meta_data_cp_Sept8 <- read_csv("meta_data_cp_Sept8.csv",
col_types = cols(...1 = col_skip()))
View(meta_data_cp_Sept8)
#Raw count sum/depth
meta_data_cp = read.csv(file = "meta_data_cp_Sept8.csv", sep = ",",header = T, skip =1)
View(meta_data_cp)
?write.csv
setwd("~/GitHub/Placenta_RNAseq_WGCNA")
load("raw_norm_combat_seq.RData")
Glowing_Placenta_RNAseq_FCandLane <- read.csv("Glowing_Placenta_RNAseq_FCandLane.csv")
nrow(Glowing_Placenta_RNAseq_FCandLane)
meta_data = read.csv("metaDataGlowing-for-TME.csv", header = T)
nrow(meta_data)
#Compare two vectors of different length in R
#only 118 IDs from meta data are represented in Glowing_Placenta_RNAseq_FCandLane
keep_IDs = which(meta_data$ID %in% Glowing_Placenta_RNAseq_FCandLane$Sample.ID == TRUE)
#not all samples have "G-" in Glowing_Placenta_RNAseq_FCandLane$Sample.ID
grepl("G-", Glowing_Placenta_RNAseq_FCandLane$Sample.ID)
newIDs = which(grepl("G-", Glowing_Placenta_RNAseq_FCandLane$Sample.ID) ==  FALSE)
#sub("G", "G-",Glowing_Placenta_RNAseq_FCandLane$Sample.ID[newIDs])
for ( i in newIDs){
Glowing_Placenta_RNAseq_FCandLane[i, "Sample.ID"] = sub("G", "G-", Glowing_Placenta_RNAseq_FCandLane[i, "Sample.ID"])
}
#G-130 has a large space
# Glowing_Placenta_RNAseq_FCandLane$Sample.ID[38] == "G-130"
# [1] FALSE
# Glowing_Placenta_RNAseq_FCandLane$Sample.ID[38]
# [1] "G-130 "
Glowing_Placenta_RNAseq_FCandLane$Sample.ID[38] ="G-130"
colnames(Glowing_Placenta_RNAseq_FCandLane)[7] = "ID"
library("tidyverse")
meta_data = dplyr::left_join(meta_data, Glowing_Placenta_RNAseq_FCandLane[,c("FC","Lane","ID")], by = "ID")
meta_data$FC = as.factor(meta_data$FC)
meta_data$Lane = as.factor(meta_data$Lane)
#Conduct PC for glowing_uq_vst
PCobj = prcomp(t(glowing_uq_vst), retx = T, center = T, scale. = T)
PCs = PCobj$x
#rownames(PCs) == meta_data$GlowRNAseqID #TRUE
#rownames(PCs) = meta_data$ID
meta_data["PC1_uq_vst"] = PCs[,1]
meta_data["PC1_uq_vst >= 25"] = (meta_data$PC1_uq_vst >= 25)
meta_data["PC2_uq_vst"] = PCs[,2]
PCobj = prcomp(t(combat.adj), retx = T, center = T, scale. = T)
PCs = PCobj$x
meta_data["PC1_combat"] = PCs[,1]
meta_data["PC2_combat"] = PCs[,2]
write.csv(meta_data, file = "meta_data_cp_Sept8.csv", col.names = T, row.names = F)
View(meta_data)
#Raw count sum/depth
meta_data_cp = read.csv(file = "meta_data_cp_Sept8.csv", sep = ",",header = T)
raw_data = t(GlowingPlacenta_RNAseq.rawCounts.nonZero.141.samples_copy)
raw_data$read_count = rep(0, nrow(raw_data))
View(raw_data)
raw_data = t(GlowingPlacenta_RNAseq.rawCounts.nonZero.141.samples_copy)
raw_data$read_count = rep(0, nrow(raw_data))
raw_data$read_count
raw_data = t(GlowingPlacenta_RNAseq.rawCounts.nonZero.141.samples_copy)
raw_data$read_count = rep(0, nrow(raw_data))
for(i in 1:length(rownames(raw_data))){
raw_data[i, 'read_count'] = sum(raw_data[i, ])
}
raw_data$read_count
for(i in 1:nrow(raw_data)){
raw_data[i, 'read_count'] = sum(raw_data[i, ])
}
1:nrow(raw_data)
nrow(raw_data)
raw_data = t(GlowingPlacenta_RNAseq.rawCounts.nonZero.141.samples_copy)
View(raw_data)
raw_data = rbind(raw_data, rep(0, nrow(raw_data)))
raw_data = cbind(raw_data, rep(0, nrow(raw_data)))
raw_data[,-1]
ncol(raw_data)
raw_data[,13832]
#Raw count sum/depth
meta_data_cp = read.csv(file = "meta_data_cp_Sept8.csv", sep = ",",header = T)
raw_data = t(GlowingPlacenta_RNAseq.rawCounts.nonZero.141.samples_copy)
raw_data = cbind(raw_data, rep(0, nrow(raw_data)))
raw_data[,13832]
for(i in 1:nrow(raw_data)){
raw_data[i, ncol(raw_data)] = sum(raw_data[i, ])
}
raw_data[,13832]
raw_data = data.frame(raw_data)
raw_data$ID = row.names(raw_data)
raw_data$ID
colnames(raw_data)[ncol(raw_data)]
ncol(raw_data)
colnames(raw_data)[13832]
colnames(raw_data)[13832] = "raw_counts"
meta_data_cp = dplyr::left_join(meta_data_cp, raw_data[,c("ID", "raw_counts")], by = "ID")
View(meta_data_cp)
ggplot(data = meta_data_cp, aes(x = raw_counts)) + geom_histogram()
ggplot(data = meta_data_cp, aes(x = raw_counts)) + geom_histogram(binwidth = 1, color="black", fill="white")
ggplot(data = meta_data_cp, aes(x = raw_counts)) + geom_histogram(color="black", fill="white")
ggplot(data = meta_data_cp, aes(x = raw_counts, color = prep)) + geom_histogram(color="black", fill="white")
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID)) + geom_histogram(color="black", fill="white")
meta_data_cp$PrepID
View(combat.adj)
View(meta_data_cp)
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID, fill = PrepID)) + geom_histogram(color="black", fill="white")
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID)) + geom_histogram()
View(GlowingPlacenta_RNAseq.rawCounts.nonZero.141.samples_copy)
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID)) + geom_histogram(fill="white", alpha=0.5, position="identity")
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID)) + geom_histogram(fill="white", alpha=0.5, position="identity") + facet_wrap(~ PrepID)
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID)) + geom_histogram( alpha=0.5, position="identity") + facet_wrap(~ PrepID)
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID, fill = PrepID)) + geom_histogram( alpha=0.5, position="identity") + facet_wrap(~ PrepID)
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID, fill = PrepID)) + geom_histogram( alpha=0.5, position="identity") + scale_x_continuous(labels = comma) + facet_wrap(~ PrepID)
options(scipen=10000)
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID, fill = PrepID)) + geom_histogram( alpha=0.5, position="identity") + facet_wrap(~ PrepID)
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID, fill = PrepID)) + geom_boxplot()
ggplot(data = meta_data_cp, aes(x = raw_counts, color = PrepID)) + geom_boxplot()
ggplot(data = meta_data_cp, aes(x = raw_counts, y = PrepID, color = PrepID)) + geom_boxplot()
ggplot(data = meta_data_cp, aes(y = raw_counts, x = PrepID, color = PrepID)) + geom_boxplot()
ggplot(data = meta_data_cp, aes(y = raw_counts,color = PrepID)) + geom_boxplot()
ggplot(data = meta_data_cp, aes(y = raw_counts)) + geom_point()
ggplot(data = meta_data_cp, aes(x = ID, y = raw_counts)) + geom_point()
View(meta_data_cp)
ggplot(data = meta_data_cp, aes(x = ID, y = 1:141)) + geom_point()
ggplot(data = meta_data_cp, aes(x = 1:141, y = raw_counts)) + geom_point()
ggplot(data = meta_data_cp, aes(x = 1:141, y = raw_counts, color = PrepID)) + geom_point()
ggplot(data = meta_data_cp, aes(x = 1:141, y = raw_counts, color = PrepID)) + geom_point() + scale_x_continuous(limits = c(1,141))
meta_data_cp[c(1, 25, 50, 75,200, 125, 141 ),"ID"]
meta_data_cp[c(1, 25, 50, 75,100, 125, 141 ),"ID"]
ggplot(data = meta_data_cp, aes(x = 1:141, y = raw_counts, color = PrepID)) + geom_point() + scale_x_continuous(breaks = c(1, 25, 50, 75,100, 125, 141 ), labels = c("G-114", "G-148" ,"G-188" ,"G-257" ,"G-312" ,"G-382", "G-419")  ) + labs(x = "IDs (ordered by row number")
View(meta_data_cp)
